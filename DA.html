<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>DA.knit</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ISDS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Week 1
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LectureWorkshopWk1.html">Lectures-Workshops-Wk1</a>
    </li>
    <li>
      <a href="lab1.html">Lab 1</a>
    </li>
    <li>
      <a href="lab2.html">Lab 2</a>
    </li>
    <li>
      <a href="lab3.html">Lab 3</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Week 2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LectureWorkshopWk2.html">Lectures-Workshops-Wk2</a>
    </li>
    <li>
      <a href="lab4.html">Lab 4</a>
    </li>
    <li>
      <a href="lab5.html">Lab 5</a>
    </li>
    <li>
      <a href="lab6.html">Lab 6</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Week 3
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LectureWorkshopWk3_Notes.html">Lecture-Workshops</a>
    </li>
    <li>
      <a href="labs_regression.html">Labs</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Week 4
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LectureWorkshopWk4_Notes.html">Lecture-Workshops</a>
    </li>
    <li>
      <a href="labs_classification.html">Labs</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">
    <span class="fa fa-info-circle"></span>
     
    About
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    R Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r_1_gettingstarted.html">1. Getting Started</a>
    </li>
    <li>
      <a href="r_2_variables.html">2. Variables</a>
    </li>
    <li>
      <a href="r_3_functions.html">3. Functions</a>
    </li>
    <li>
      <a href="r_4_vectors.html">4. Vectors</a>
    </li>
    <li>
      <a href="r_5_basicstats.html">5. Standard statistical functions</a>
    </li>
    <li>
      <a href="r_6_matrices.html">6. Matrices and data frames</a>
    </li>
    <li>
      <a href="r_7_plots.html">7. Plots</a>
    </li>
    <li>
      <a href="r_8_advplots.html">8. Advanced Plots</a>
    </li>
    <li>
      <a href="r_9_programming.html">9. Programming</a>
    </li>
    <li>
      <a href="r_10_statsmethods.html">10. Statistical methods</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<p>Discriminant analysis requires a <strong>discriminant function</strong> for each group, <span class="math inline">\(k=1,\ldots,K\)</span>, which we denote by <span class="math inline">\(Q_k\)</span>. Consider a vector of <span class="math inline">\(p\)</span> predictor variables, which it is convenient to write as
<span class="math display">\[\begin{equation*}
\boldsymbol{x} =
\begin{pmatrix}
x_1\\
x_2\\
\vdots\\
x_p
\end{pmatrix} = (x_1, x_2, \ldots, x_p)^T.
\end{equation*}\]</span>
When we input <span class="math inline">\(\boldsymbol{x}\)</span> into each of the discriminant functions, the output is a real number, so we would get <span class="math inline">\(K\)</span> real numbers <span class="math inline">\(Q_1(\boldsymbol{x}), \ldots, Q_K(\boldsymbol{x})\)</span>. For the different values <span class="math inline">\(\boldsymbol{x} = (x_1, \ldots, x_p)^T\)</span> that <span class="math inline">\(\boldsymbol{X} = (X_1, \ldots, X_p)^T\)</span> can take, one of the <span class="math inline">\(K\)</span> real numbers, say <span class="math inline">\(Q_k(\boldsymbol{x})\)</span>, will be larger than the others. We use this idea to divide up the whole space of values that <span class="math inline">\(\boldsymbol{X}\)</span> can take into <span class="math inline">\(K\)</span> non-overlapping parts, <span class="math inline">\(R_1,R_2,\ldots,R_K\)</span>, (called <strong>allocation regions</strong>) according to the rule
<span class="math display">\[\begin{equation*}
\text{if } Q_k(\boldsymbol{x}) &gt; Q_{\ell}(\boldsymbol{x}), \text{ for all $\ell \ne k$, then $\boldsymbol{x}$ lies in $R_k$}.
\end{equation*}\]</span>
If <span class="math inline">\(\boldsymbol{x}\)</span> lies in <span class="math inline">\(R_k\)</span> then we assign <span class="math inline">\(Y = k\)</span>.</p>
<p>When trained on a particular data set, different discriminant functions will lead to different allocation regions and the allocation regions created by some methods are likely to be more effective than others for correctly predicting the group in which a new observation lies.</p>
<p>The so-called <strong>Bayes classifier</strong> is based on <a href="#eq:bayesclassification2">(<strong>??</strong>)</a> and simply assigns an observation <span class="math inline">\(\boldsymbol{x}\)</span> to the class <span class="math inline">\(k\)</span> for which the posterior probability <span class="math inline">\(p_k(\boldsymbol{x}) = \Pr(Y = k | \boldsymbol{X} = \boldsymbol{x}) = \Pr(Y = k | X_1 = x_1, \ldots, X_p = x_p)\)</span> is largest. It can be shown that this is equivalent to assigning <span class="math inline">\(\boldsymbol{x}\)</span> to class <span class="math inline">\(k\)</span> if and only if
<span class="math display">\[\begin{align*}
f_k(\boldsymbol{x}) \pi_k &gt; f_{\ell}(\boldsymbol{x}) \pi_{\ell}
\end{align*}\]</span>
for all <span class="math inline">\(\ell \ne k\)</span>. Therefore the corresponding discriminant functions are
<span class="math display">\[\begin{equation*}
Q_k(\boldsymbol{x}) = f_k(\boldsymbol{x}) \pi_k, \quad k=1,\ldots,K.
\end{equation*}\]</span>
In the special case when all the prior group probabilities are equal, i.e. <span class="math inline">\(\pi_1 = \pi_2 = \ldots = \pi_K = 1/K\)</span>, the discriminant functions simplify to
<span class="math display">\[\begin{equation*}
Q_k(\boldsymbol{x}) = f_k(\boldsymbol{x}), \quad k=1,\ldots,K.
\end{equation*}\]</span>
In this case the resulting rule for classification is called the <strong>maximum likelihood discriminant rule</strong> because an observation is assigned to the group with the maximum likelihood.</p>
<div id="the-multivariate-normal-distribution-a-concise-summary" class="section level2" number="0.1">
<h2><span class="header-section-number">0.1</span> The Multivariate Normal Distribution: A Concise Summary</h2>
<p>A <strong>random p-vector</strong> <span class="math inline">\(\boldsymbol{X} = (X_1,\ldots,X_p)^T\)</span> is a <span class="math inline">\(p\)</span>-dimensional vector whose elements, <span class="math inline">\(X_1,\ldots,X_p\)</span>, are all random variables. It is called a continuous random vector if all the <span class="math inline">\(X_j\)</span> are continous and a discrete random vector if all the <span class="math inline">\(X_j\)</span> are discrete. The normal distribution is a model for a continuous random variable <span class="math inline">\(X\)</span>. The multivariate normal distribution provides a generalisation for a continuous random vector <span class="math inline">\(\boldsymbol{X}\)</span> with <span class="math inline">\(p&gt;1\)</span>. Here we provide a very concise summary.</p>
<p>Recall from the first half of this module that if a random variable <span class="math inline">\(X\)</span> has a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>, written <span class="math inline">\(X \sim \mathrm{N}(\mu, \sigma^2)\)</span>, then its probability density function is given by
<span class="math display">\[\begin{equation*}
f(x) = \frac{1}{\sqrt{2 \pi \sigma^2}} \exp \left\{ -\frac{1}{2 \sigma^2}(x-\mu)^2 \right\}.
\end{equation*}\]</span>
For example, if <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma^2=1\)</span>, a plot of the probability density function is shown in the left-hand image of Figure <a href="#fig:univariatenormal"><strong>??</strong></a>. Recall that the probability of <span class="math inline">\(X\)</span> taking a value between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> is just the area under the curve between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> as indicated in the right-hand plot of Figure <a href="#fig:univariatenormal"><strong>??</strong></a>. Therefore <span class="math inline">\(X\)</span> is more likely to take values in regions where the density function is large.</p>
<p>If <span class="math inline">\(\boldsymbol{X} = ( X_1, X_2, \ldots, X_p )^T\)</span> is a random <span class="math inline">\(p\)</span>-vector, it does not have a single mean and a single variance. Instead, there is a mean <span class="math inline">\(\mu_j\)</span> for each random variable <span class="math inline">\(X_j\)</span>. These are collected into a length-<span class="math inline">\(p\)</span> column vector <span class="math inline">\(\boldsymbol{\mu} = (\mu_1, \mu_2, \ldots, \mu_p)^T\)</span>. Similarly, each <span class="math inline">\(X_j\)</span> has its own variance <span class="math inline">\(\sigma_{jj}\)</span> and every pair of random variables <span class="math inline">\(X_j\)</span> and <span class="math inline">\(X_k\)</span> has a covariance <span class="math inline">\(\sigma_{jk}\)</span> which provides information about the relationship between <span class="math inline">\(X_j\)</span> and <span class="math inline">\(X_k\)</span>, e.g. its sign indicates whether there is a positive or negative correlation. These variances and covariances are collected into a <span class="math inline">\(p \times p\)</span> covariance matrix
<span class="math display">\[\begin{equation*}
\Sigma =
\begin{pmatrix}
\sigma_{11} &amp;\sigma_{12} &amp;\cdots &amp;\sigma_{1p}\\
\sigma_{21} &amp;\sigma_{22} &amp;\cdots &amp;\sigma_{2p}\\
\vdots &amp;\vdots &amp;\ddots &amp;\vdots\\
\sigma_{p1} &amp;\sigma_{p2} &amp;\cdots &amp;\sigma_{pp}\\
\end{pmatrix}
\end{equation*}\]</span>
which is symmetric (meaning <span class="math inline">\(\sigma_{ij} = \sigma_{ji}\)</span>) and positive definite (the matrix analogue of “positive”).</p>
<p>Now, if a random <span class="math inline">\(p\)</span>-vector <span class="math inline">\(\boldsymbol{X} = ( X_1, X_2, \ldots, X_p )^T\)</span> has a multivariate normal distribution with mean vector <span class="math inline">\(\boldsymbol{\mu}\)</span> and covariance matrix <span class="math inline">\(\Sigma\)</span>, written <span class="math inline">\(\boldsymbol{X} \sim \mathrm{N}_p(\boldsymbol{\mu}, \Sigma)\)</span>, then its probability density function is given by
<span class="math display">\[\begin{equation*}
f(\boldsymbol{x}) = \frac{1}{(2 \pi)^{p/2} | \Sigma |^{1/2}} \exp \left\{ -\frac{1}{2} (\boldsymbol{x} - \boldsymbol{\mu})^T \Sigma^{-1} (\boldsymbol{x} - \boldsymbol{\mu}) \right\}.
\end{equation*}\]</span>
This expression involves matrix algebra, but the important thing to note is that for any value <span class="math inline">\(\boldsymbol{x}\)</span>, <span class="math inline">\(f(\boldsymbol{x})\)</span> is just a real number. For example, if <span class="math inline">\(p=2\)</span> we have a bivariate normal distribution and can generate a 3-dimensional plot to show the probability density function. For two sets of values for the parameters, <span class="math inline">\(\boldsymbol{\mu}\)</span> and <span class="math inline">\(\Sigma\)</span>, density functions are displayed in Figure <a href="#fig:bivariatenormal"><strong>??</strong></a>. Just like in the univariate case, the probability that <span class="math inline">\(X_1\)</span> lies between <span class="math inline">\(a_1\)</span> and <span class="math inline">\(b_1\)</span> and that <span class="math inline">\(X_2\)</span> lies between <span class="math inline">\(a_2\)</span> and <span class="math inline">\(b_2\)</span> is just the volume under the surface over the rectangular region with corners at <span class="math inline">\((a_1, a_2)\)</span>, <span class="math inline">\((a_1, b_2)\)</span>, <span class="math inline">\((b_1, b_2)\)</span> and <span class="math inline">\((b_1, a_2)\)</span>. Again <span class="math inline">\(\boldsymbol{X}=(X_1, X_2)^T\)</span> is more likely to take values in regions where the density function is large.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
